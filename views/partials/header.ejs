<!DOCTYPE html>
<html>
<head>
	<title>My Resistance</title>

	<link rel="stylesheet" type="text/css" href="/libraries/bootstrap-3.3.7-dist/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/stylesheets/index.css">




	<script type="text/javascript" src="/libraries/jquery-3.2.1.js"></script>
	<script type="text/javascript" src="/libraries/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
	<!-- Sweet alert! -->
	<!-- <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script> -->
	<script src="/libraries/sweetalert2.1.0.min.js"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1" /> 

</head>
<body>

	<style>
		.fontButton{
			width: 30px;
			height: 30px;
			border: 1px solid black;
		}
	</style>


	<nav class="navbar navbar-default container-fullwidth ">
		<div class="container" id="navBarContainerId">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"><img id="brand" alt="Brand" src="../../../../pictures/logo.png"></a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">

					<% if(headerActive){%>

					<% if(headerActive === "lobby"){ %>
					<li class="active"><a href="/lobby">Lobby</a></li>
					<%} %>
					<% if(headerActive !== "lobby"){ %>
					<li><a href="/lobby">Lobby</a></li>
					<% } %>

					<% if(headerActive === "rules"){ %>
					<li class="active"><a href="/rules">Rules</a></li>
					<%} %>
					<% if(headerActive !== "rules"){ %>
					<li><a href="/rules">Rules</a></li>
					<% } %>

					<% if(headerActive === "forums"){ %>
					<li class="active"><a href="/forum">Forums</a></li>
					<%} %>
					<% if(headerActive !== "forums"){ %>
					<li><a href="/forum">Forums</a></li>
					<% } %>

					<% if(headerActive === "log"){ %>
					<li class="active"><a href="/log">Change log</a></li>
					<%} %>
					<% if(headerActive !== "log"){ %>
					<li><a href="/log">Change Log</a></li>
					<% } %>

					<%}%>

					<!-- <li><a href="#">News</a></li> -->
				</ul>


				<ul class="nav navbar-nav navbar-right">
					<!-- <li><a href="#">About</a></li> -->

					<!-- <li><a href="#">Contact us</a></li> -->

					<% if(currentUser){%>
					<li>
						<li class="dropdown">
							<a href="#" role="button" data-toggle="modal" data-target="#optionsModal">
								<span class="glyphicon glyphicon-cog"></span>
							</a> 
						</li>
					</li>
					<!-- <li><a href="#">Hi there, <%=currentUser.username%></a></li> -->
					<li><a class="" id="originalUsername"><%=currentUser.username%></a></li>

					<li><a href="/logout">Log out</a></li>
					<%}%>

				</ul>
			</div><!-- /.navbar-collapse -->
		</div><!-- /.container-fluid -->
	</nav>

	<div class="container">


		<!-- MY NOTIFICATION REQUESTS - does NOT need to reload -->
		<a id="danger-alert-box-button" class="inactive-window">
			<div class="alert alert-danger inactive-window" id="danger-alert-box">
			</div>	
		</a>

		<a id="success-alert-box-button" class="inactive-window">
			<div class="alert alert-success inactive-window" id="success-alert-box">
			</div>	
		</a>


		<!-- FLASH NOTIFICATION REQUESTS - does need to reload -->
		<% if(error && error.length > 0){ %>
		<div class="alert alert-danger" role="alert">
			<%= error%>
		</div>
		<%}%>

		<% if(success && success.length > 0){ %>
		<div class="alert alert-success" role="alert">
			<%= success%>
		</div>
		<%}%>

	</div>

	<style type="text/css">
	.inactive-window{
		display: none;
	}

	nav div ul li a {
		padding-left: 10px !important;
		padding-right: 10px !important;
	}

</style>

<script type="text/javascript">

</script>










<style>
	#leftOptionsCategories ul li { 
		background: #EAEAEA; 
	}
	#leftOptionsCategories ul li:nth-child(odd) { 
		background: #E2E2E2;
	}

	.optionCategoriesText {
		margin: 0px;
		padding-top: 5px;
		padding-bottom: 5px;
	}

	#leftOptionsCategoriesTable tbody tr td {
		border: transparent 2px solid;

		
	}

	#leftOptionsCategoriesTable tbody tr td:hover {
		border: green 2px solid;

	}

	.lobby-table {
		border-radius: 5px;
		/*border: 1px solid #ddd;*/
		border-collapse: separate;
		border-spacing: 1px;
	}

	#borderBar {
		border-left: 2px solid gray; 
		height: 100%;
		width:0px;
		padding: 0px;
		margin-left: 15px;
	}

	.optionsInputList {
		
	}

	.myActive {
		background: #ABABAB;
	}

	.subBox {
		border-radius: 15px;
		border: 1px dashed gray;
		padding-left: 15px;

		margin-bottom: 10px;
	}

	#rightOptionsMenu {
		overflow: auto;
	}
	
	
</style>


<!-- Modal -->
<div id="optionsModal" class="modal fade" role="dialog">
	<div class="modal-dialog modal-lg">

		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h2 class="modal-title">Settings</h2>
			</div>
			<div class="modal-body" >

				<div class="row" style="height: 60vh; ">

					<div id="leftOptionsCategories" class="col-xs-4 col-md-3">

						<table id="leftOptionsCategoriesTable" class="table table-bordered table-striped lobby-table">
							<tbody>
								<tr>
									<td id="generalOptionsButton" class="myActive">
										<span class="optionCategoriesText">
											General
										</span>
									</td>
								</tr>

								<tr>
									<td id="displayOptionsButton">
										<span class="optionCategoriesText">
											Display
										</span>
									</td>
								</tr>

								<tr>
									<td id="notificationsOptionsButton">
										<span class="optionCategoriesText">
											Notifications
										</span>
									</td>
								</tr>

								<tr>
									<td id="resetOptionsButton">
										<span class="optionCategoriesText">
											Reset
										</span>
									</td>
								</tr>
								
							</tbody>
						</table>
					</div>
					<div id="borderBar" class="col-xs-1">
					</div>

					<div id="rightOptionsMenu" class="col-xs-7 col-md-8">
						<div id="generalOptionsMenu" class="rightMenu">
							<h4><u>General: </u></h4>
							<div>
								<label>Font size: <input type="text" name="option_general_font_size_text" id="option_general_font_size_text" style="width: 3em;"></label>
							</div>	
						</div>


						<div id="displayOptionsMenu" class="hidden rightMenu">
							<h4><u>Display: </u></h4>
							<div>
								<label>Height of avatar area: <input type="text" name="option_display_avatar_container_height_text" id="option_display_avatar_container_height_text" style="width: 3em;"></label>
							</div>
							<div>
								<label><input type="checkbox" name="option_display_dark_theme" id="option_display_dark_theme"> Dark theme</label>
							</div>
							<div>
								<label><input type="checkbox" name="option_display_two_tabs" id="option_display_two_tabs"> Two tabs</label>
							</div>
						</div>

						


						<div id="notificationsOptionsMenu" class="hidden rightMenu">
							<h4><u>Notifications: </u></h4>
							
							<div class="subBox">
								<h5><u>Sound: </u></h5>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Enabled </label>
								</div>
								<div>
									<label style="display: inline-flex">
										Volume:
										<span style="padding-left: 15px;"></span>
										<input type="range" min=0 max=100 value=100 name="option_notifications_volume" id="option_notifications_volume">
										<span style="padding-left: 15px;"></span>
										<span id="volumeValue">100</span>
									</label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Players joining room </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Players joining game </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Game starting </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Your turn when not viewing </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Game ending</label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Buzzing </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Slapping</label>
								</div>
							</div>


							<div class="subBox">
								<h5><u>Desktop notifications: </u></h5>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Enabled </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Players joining room </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Players joining game </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Game starting </label>
								</div>


								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Enabled during game </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Your turn and not viewing the window </label>
								</div>
								<div>
									<label><input type="checkbox" name="option_dark_theme" id="option_dark_theme"> Game finishes and not viewing the window </label>
								</div>


								<div>
									<label><input type="text" name="option_dark_theme" id="option_dark_theme" style="width: 3em;"> Seconds before you can be buzzed again</label>
								</div>
							</div>
						</div>



						<div id="resetOptionsMenu" class="hidden rightMenu">
							<h4><u>Reset: </u></h4>
							<button class="btn btn-danger" onclick="resetCookies()">Reset all settings</button>

							<script src="/libraries/cookies_min.js"></script>
							<script>
								function resetCookies(){
									swal({
										title: "Do you really want to reset your settings?",
										text: "Settings such as height of gameplay area, dark mode, colour will be reset. You will not be able to recover your settings!",
										icon: "warning",
										buttons: ["Cancel", "Delete"],
										dangerMode: true,
										})
										.then((willDelete) => {
										if (willDelete) {
											
											//get all the keys
											var keys = docCookies.keys();
						
											//remove each item
											for(var i = 0; i < keys.length; i++){
												docCookies.removeItem(keys[i]);
											}
						
											swal("Poof! Your settings have been reset!", {
											icon: "success",
											}).then(() =>{
												//reload
												location.reload();
											});
						
											
										} else {
											swal("Your settings are safe!");
										}
									});
								}
							</script>
						</div>
						
					</div>



				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>

	</div>
</div>

<script>

var a;

	var optionsList = [
		"general",
		"display",
		"notifications",
		"reset"
	]

	for(var i = 0; i < optionsList.length; i++){
		$("#" + optionsList[i] + "OptionsButton").on("click", function(){
			console.log(this);
			a = this;

			var openThisMenu = this.innerText.toLowerCase().slice(0, this.innerText.length) + "OptionsMenu";
			console.log("open this: " + openThisMenu);

			closeAllMenuOptions();

			$("#" + openThisMenu).removeClass("hidden");


			removeMyActiveOffAllButtons();
			this.classList.add("myActive");


		});
	}

	function closeAllMenuOptions(){
		for(var i = 0; i < optionsList.length; i++){
			$("#" + optionsList[i] + "OptionsMenu").addClass("hidden");
		} 
	}

	function removeMyActiveOffAllButtons() {
		for(var i = 0; i < optionsList.length; i++){
			$("#" + optionsList[i] + "OptionsButton").removeClass("myActive");
		} 
	}


	var volumeSlider = document.getElementById("option_notifications_volume");
	var volumeDisplay = $("#volumeValue");

	volumeSlider.oninput = function(){
		volumeDisplay[0].innerHTML = volumeSlider.value;
	};

</script>